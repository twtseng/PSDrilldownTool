{"QueryScripts":[{"Name":"ImportAmazon","ScriptText":"$filematches = select-string \"Order Date,Order ID,Title\" -path \"C:\\Users\\tomts\\Downloads\\BILLS\\*.csv\"\n$filematches | select -unique Path | % {\n   \"Importing: \"+$_.Path\n   $x = import-csv $_.Path\n   $x | % { add-member -inputobject $_ -membertype noteproperty -name JSON -Value (convertto-json $_) }\n   $y = $x | select json\n   Write-ObjectsToSQLServer -ObjectArray $y -DestinationConnStr $env:MyDbConnStr -InputSproc [usp_AmazonBills_Insert] -BatchSize 100\n}\n","TranslatedScript":"$filematches = select-string \"Order Date,Order ID,Title\" -path \"C:\\Users\\tomts\\Downloads\\BILLS\\*.csv\"\n$filematches | select -unique Path | % {\n   \"Importing: \"+$_.Path\n   $x = import-csv $_.Path\n   $x | % { add-member -inputobject $_ -membertype noteproperty -name JSON -Value (convertto-json $_) }\n   $y = $x | select json\n   Write-ObjectsToSQLServer -ObjectArray $y -DestinationConnStr $env:MyDbConnStr -InputSproc [usp_AmazonBills_Insert] -BatchSize 100\n}\n","RunOnParentRowSelect":false,"ResultDataTable":[],"ResultText":"Importing: C:\\Users\\tomts\\Downloads\\BILLS\\01-Jan-2019_to_29-Jan-2020.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[402] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.02]\r\n200\r\nWrite-ObjectsToSQLServer processed [200]/[402] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.03]\r\n200\r\nWrite-ObjectsToSQLServer processed [300]/[402] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.04]\r\n167\r\nWrite-ObjectsToSQLServer processed [400]/[402] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.05]\r\n2\r\nWrite-ObjectsToSQLServer processed [402]/[402] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.06]\r\nWrite-ObjectsToSQLServer Completed. Total items [402]. InputSproc[[usp_AmazonBills_Insert]]. ElapsedMins[0.06]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\01-Jan-2020_to_18-Apr-2020.csv\r\n100\r\nWrite-ObjectsToSQLServer processed [100]/[107] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.01]\r\n7\r\nWrite-ObjectsToSQLServer processed [107]/[107] InputSproc[[usp_AmazonBills_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [107]. InputSproc[[usp_AmazonBills_Insert]]. ElapsedMins[0.01]\r\nSCRIPT COMPLETED. Time:[04/20/20 13:48:59] Duration:[00:00:04]","StartTime":"2020-04-20T13:48:55.0412346-07:00","EndTime":"2020-04-20T13:48:59.4302215-07:00","Duration":"00:00:04.3889869","TaskStatus":2},{"Name":"ImportCredit","ScriptText":"$filematches = select-string \"Posted Date,Reference Number\" -path \"C:\\Users\\tomts\\Downloads\\BILLS\\*.csv\"\n$filematches | select -unique Path | % {\n   \"Importing: \"+$_.Path\n   $x = import-csv $_.Path\n   $x | % { add-member -inputobject $_ -membertype noteproperty -name JSON -Value (convertto-json $_) }\n   $y = $x | select json\n   Write-ObjectsToSQLServer -ObjectArray $y -DestinationConnStr $env:MyDbConnStr -InputSproc [usp_Credit_Insert] -BatchSize 100\n}","TranslatedScript":"$filematches = select-string \"Posted Date,Reference Number\" -path \"C:\\Users\\tomts\\Downloads\\BILLS\\*.csv\"\n$filematches | select -unique Path | % {\n   \"Importing: \"+$_.Path\n   $x = import-csv $_.Path\n   $x | % { add-member -inputobject $_ -membertype noteproperty -name JSON -Value (convertto-json $_) }\n   $y = $x | select json\n   Write-ObjectsToSQLServer -ObjectArray $y -DestinationConnStr $env:MyDbConnStr -InputSproc [usp_Credit_Insert] -BatchSize 100\n}","RunOnParentRowSelect":false,"ResultDataTable":[],"ResultText":"Importing: C:\\Users\\tomts\\Downloads\\BILLS\\April2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[170] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.02]\r\n140\r\nWrite-ObjectsToSQLServer processed [170]/[170] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.03]\r\nWrite-ObjectsToSQLServer Completed. Total items [170]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.03]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\August2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[191] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n182\r\nWrite-ObjectsToSQLServer processed [191]/[191] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [191]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\December2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[160] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\n120\r\nWrite-ObjectsToSQLServer processed [160]/[160] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [160]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\February2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[129] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n58\r\nWrite-ObjectsToSQLServer processed [129]/[129] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [129]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\January2020_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[123] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n46\r\nWrite-ObjectsToSQLServer processed [123]/[123] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [123]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\July2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[227] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n200\r\nWrite-ObjectsToSQLServer processed [200]/[227] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\n54\r\nWrite-ObjectsToSQLServer processed [227]/[227] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [227]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\June2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[153] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n106\r\nWrite-ObjectsToSQLServer processed [153]/[153] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [153]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\March2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[116] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n32\r\nWrite-ObjectsToSQLServer processed [116]/[116] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [116]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\March2020_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[131] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n62\r\nWrite-ObjectsToSQLServer processed [131]/[131] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [131]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\May2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[170] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n140\r\nWrite-ObjectsToSQLServer processed [170]/[170] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [170]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\November2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[135] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n70\r\nWrite-ObjectsToSQLServer processed [135]/[135] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [135]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\October2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[129] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\n58\r\nWrite-ObjectsToSQLServer processed [129]/[129] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [129]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nImporting: C:\\Users\\tomts\\Downloads\\BILLS\\September2019_6574.csv\r\n200\r\nWrite-ObjectsToSQLServer processed [100]/[141] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.00]\r\n82\r\nWrite-ObjectsToSQLServer processed [141]/[141] InputSproc[[usp_Credit_Insert]] ElapsedMins[0.01]\r\nWrite-ObjectsToSQLServer Completed. Total items [141]. InputSproc[[usp_Credit_Insert]]. ElapsedMins[0.01]\r\nSCRIPT COMPLETED. Time:[04/20/20 15:25:11] Duration:[00:00:08]","StartTime":"2020-04-20T15:25:02.9982595-07:00","EndTime":"2020-04-20T15:25:11.6938596-07:00","Duration":"00:00:08.6956001","TaskStatus":2},{"Name":"ImportChecking","ScriptText":"$filematches = select-string \"Date,Description,Amount\" -path \"C:\\Users\\tomts\\Downloads\\BILLS\\*.csv\"\n$filematches | select -unique Path | % {\n   \"Importing: \"+$_.Path\n   $content = gc $_.Path\n   $tempFile = \"checkingtempfile.csv\"\n   $content[($_.LineNumber-1)..$($content.Length)] | out-file $tempFile \n   $x = import-csv $tempFile\n   del $tempFile\n   $x | % { add-member -inputobject $_ -membertype noteproperty -name JSON -Value (convertto-json $_) }\n   $y = $x | select json\n   Write-ObjectsToSQLServer -ObjectArray $y -DestinationConnStr $env:MyDbConnStr -InputSproc [usp_Checking_Insert] -BatchSize 100\n}","TranslatedScript":"$filematches = select-string \"Date,Description,Amount\" -path \"C:\\Users\\tomts\\Downloads\\BILLS\\*.csv\"\n$filematches | select -unique Path | % {\n   \"Importing: \"+$_.Path\n   $content = gc $_.Path\n   $tempFile = \"checkingtempfile.csv\"\n   $content[($_.LineNumber-1)..$($content.Length)] | out-file $tempFile \n   $x = import-csv $tempFile\n   del $tempFile\n   $x | % { add-member -inputobject $_ -membertype noteproperty -name JSON -Value (convertto-json $_) }\n   $y = $x | select json\n   Write-ObjectsToSQLServer -ObjectArray $y -DestinationConnStr $env:MyDbConnStr -InputSproc [usp_Checking_Insert] -BatchSize 100\n}","RunOnParentRowSelect":false,"ResultDataTable":null,"ResultText":null,"StartTime":"0001-01-01T00:00:00","EndTime":"0001-01-01T00:00:00","Duration":"00:00:00","TaskStatus":0}],"LibraryScripts":{"invoke-sqlquery.ps1":"..\\..\\Scripts\\invoke-sqlquery.ps1"},"Variables":{"bandfilter":"b*"},"Settings":{"QueryScriptFont":"Consolas, 9.75pt","ResultTableFont":"Courier New, 9.75pt","TextResultsFont":"Copperplate Gothic Light, 15.75pt"}}